{"ast":null,"code":"var _jsxFileName = \"/home/arafat/codes/pickbazar/client/packages/shop/src/pages/checkout.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport Router from 'next/router';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Modal } from '@redq/reuse-modal';\nimport { SEO } from 'components/seo';\nimport Checkout from 'features/checkouts/checkout-two/checkout-two';\nimport { GET_LOGGED_IN_USER } from 'graphql/query/customer.query';\nimport { DELIVERY_METHOD } from 'graphql/query/delivery';\nimport { PAYMENT_OPTION } from 'graphql/query/paymentoption';\nimport { ProfileProvider } from 'contexts/profile/profile.provider';\nimport ErrorMessage from 'components/error-message/error-message';\n\nconst CheckoutPage = ({\n  deviceType\n}) => {\n  const {\n    data: deliverData,\n    error: deliveryError,\n    loading: deliveryLoading,\n    refetch: deliveryRefetch\n  } = useQuery(DELIVERY_METHOD);\n  const {\n    data: paymentData,\n    error: paymentError,\n    loading: paymentLoading,\n    refetch: paymentRefetch\n  } = useQuery(PAYMENT_OPTION);\n  deliveryRefetch();\n  paymentRefetch();\n  const {\n    data,\n    error,\n    loading\n  } = useQuery(GET_LOGGED_IN_USER);\n\n  if (loading || deliveryLoading || paymentLoading) {\n    return __jsx(ErrorMessage, {\n      message: 'Loading...',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 12\n      }\n    });\n  }\n\n  if (error || deliveryError || paymentError) {\n    setTimeout(function () {\n      Router.push('/');\n    }, 2000);\n    return __jsx(ErrorMessage, {\n      message: 'Please login for checkout',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 7\n      }\n    });\n  }\n\n  const token = 'true';\n  console.dir(deliverData.deliveryMethods);\n  console.dir(paymentData.paymentOptions);\n\n  const checkoutData = _objectSpread(_objectSpread({}, data.getUser), {}, {\n    deliveryMethods: [],\n    paymentMethods: []\n  });\n\n  console.dir(deliverData);\n  console.dir(paymentData);\n  console.log(checkoutData, checkoutData.deliveryMethods.length, checkoutData.paymentMethods.length);\n\n  if (checkoutData.deliveryMethods.length == 0 && (deliverData || deliverData.deliveryMethods)) {\n    checkoutData.deliveryMethods = [...deliverData.deliveryMethods.items];\n  }\n\n  if (checkoutData.paymentMethods.length == 0 && (paymentData || paymentData.paymentOptions)) {\n    checkoutData.paymentMethods = [...paymentData.paymentOptions.items];\n  }\n\n  return __jsx(React.Fragment, null, __jsx(SEO, {\n    title: \"Checkout - Mahdi Fashion\",\n    description: \"Checkout Details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }\n  }), __jsx(ProfileProvider, {\n    initData: checkoutData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, __jsx(Modal, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, __jsx(Checkout, {\n    token: token,\n    deviceType: deviceType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default CheckoutPage;","map":{"version":3,"sources":["/home/arafat/codes/pickbazar/client/packages/shop/src/pages/checkout.tsx"],"names":["React","Router","useQuery","Modal","SEO","Checkout","GET_LOGGED_IN_USER","DELIVERY_METHOD","PAYMENT_OPTION","ProfileProvider","ErrorMessage","CheckoutPage","deviceType","data","deliverData","error","deliveryError","loading","deliveryLoading","refetch","deliveryRefetch","paymentData","paymentError","paymentLoading","paymentRefetch","setTimeout","push","token","console","dir","deliveryMethods","paymentOptions","checkoutData","getUser","paymentMethods","log","length","items"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,MAAiC,OAAjC;AAEA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,QAAT,QAAyB,qBAAzB;AACA,SAASC,KAAT,QAAsB,mBAAtB;AACA,SAASC,GAAT,QAAoB,gBAApB;AACA,OAAOC,QAAP,MAAqB,8CAArB;AACA,SAASC,kBAAT,QAAmC,8BAAnC;AACA,SAASC,eAAT,QAAgC,wBAAhC;AACA,SAASC,cAAT,QAA+B,6BAA/B;AACA,SAASC,eAAT,QAAgC,mCAAhC;AACA,OAAOC,YAAP,MAAyB,wCAAzB;;AASA,MAAMC,YAA6B,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAoB;AACxD,QAAM;AAAEC,IAAAA,IAAI,EAAEC,WAAR;AAAqBC,IAAAA,KAAK,EAAEC,aAA5B;AAA2CC,IAAAA,OAAO,EAAEC,eAApD;AAAqEC,IAAAA,OAAO,EAAEC;AAA9E,MAAmGlB,QAAQ,CAACK,eAAD,CAAjH;AACA,QAAM;AAAEM,IAAAA,IAAI,EAAEQ,WAAR;AAAqBN,IAAAA,KAAK,EAAEO,YAA5B;AAA0CL,IAAAA,OAAO,EAAEM,cAAnD;AAAmEJ,IAAAA,OAAO,EAAEK;AAA5E,MAA+FtB,QAAQ,CAACM,cAAD,CAA7G;AACAY,EAAAA,eAAe;AACfI,EAAAA,cAAc;AAEd,QAAM;AAAEX,IAAAA,IAAF;AAAQE,IAAAA,KAAR;AAAeE,IAAAA;AAAf,MAA2Bf,QAAQ,CAACI,kBAAD,CAAzC;;AAEA,MAAIW,OAAO,IAAIC,eAAX,IAA8BK,cAAlC,EAAkD;AAChD,WAAO,MAAC,YAAD;AAAc,MAAA,OAAO,EAAE,YAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACD;;AACD,MAAIR,KAAK,IAAIC,aAAT,IAA0BM,YAA9B,EAA4C;AAC1CG,IAAAA,UAAU,CAAC,YAAY;AACrBxB,MAAAA,MAAM,CAACyB,IAAP,CAAY,GAAZ;AACD,KAFS,EAEP,IAFO,CAAV;AAGA,WACE,MAAC,YAAD;AAAc,MAAA,OAAO,EAAE,2BAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAGD;;AACD,QAAMC,KAAK,GAAG,MAAd;AAGAC,EAAAA,OAAO,CAACC,GAAR,CAAYf,WAAW,CAACgB,eAAxB;AACAF,EAAAA,OAAO,CAACC,GAAR,CAAYR,WAAW,CAACU,cAAxB;;AAEA,QAAMC,YAAY,mCACbnB,IAAI,CAACoB,OADQ;AAEhBH,IAAAA,eAAe,EAAE,EAFD;AAGhBI,IAAAA,cAAc,EAAE;AAHA,IAAlB;;AAODN,EAAAA,OAAO,CAACC,GAAR,CAAYf,WAAZ;AACCc,EAAAA,OAAO,CAACC,GAAR,CAAYR,WAAZ;AACFO,EAAAA,OAAO,CAACO,GAAR,CAAYH,YAAZ,EAA0BA,YAAY,CAACF,eAAb,CAA6BM,MAAvD,EAA+DJ,YAAY,CAACE,cAAb,CAA4BE,MAA3F;;AAEE,MAAGJ,YAAY,CAACF,eAAb,CAA6BM,MAA7B,IAAuC,CAAvC,KAA6CtB,WAAW,IAAIA,WAAW,CAACgB,eAAxE,CAAH,EAA6F;AAC3FE,IAAAA,YAAY,CAACF,eAAb,GAA+B,CAAC,GAAGhB,WAAW,CAACgB,eAAZ,CAA4BO,KAAhC,CAA/B;AACD;;AAED,MAAGL,YAAY,CAACE,cAAb,CAA4BE,MAA5B,IAAsC,CAAtC,KAA4Cf,WAAW,IAAIA,WAAW,CAACU,cAAvE,CAAH,EAA2F;AACzFC,IAAAA,YAAY,CAACE,cAAb,GAA8B,CAAC,GAAGb,WAAW,CAACU,cAAZ,CAA2BM,KAA/B,CAA9B;AACD;;AAID,SACE,4BACE,MAAC,GAAD;AAAK,IAAA,KAAK,EAAC,0BAAX;AAAsC,IAAA,WAAW,EAAC,kBAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,MAAC,eAAD;AAAiB,IAAA,QAAQ,EAAEL,YAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,QAAD;AAAU,IAAA,KAAK,EAAEL,KAAjB;AAAwB,IAAA,UAAU,EAAEf,UAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,CAFF,CADF;AAUD,CAxDD;;AA0DA,eAAeD,YAAf","sourcesContent":["import React, { useEffect } from 'react';\nimport { NextPage, GetStaticProps } from 'next';\nimport Router from 'next/router';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Modal } from '@redq/reuse-modal';\nimport { SEO } from 'components/seo';\nimport Checkout from 'features/checkouts/checkout-two/checkout-two';\nimport { GET_LOGGED_IN_USER } from 'graphql/query/customer.query';\nimport { DELIVERY_METHOD } from 'graphql/query/delivery';\nimport { PAYMENT_OPTION } from 'graphql/query/paymentoption';\nimport { ProfileProvider } from 'contexts/profile/profile.provider';\nimport ErrorMessage from 'components/error-message/error-message';\n\ntype Props = {\n  deviceType: {\n    mobile: boolean;\n    tablet: boolean;\n    desktop: boolean;\n  };\n};\nconst CheckoutPage: NextPage<Props> = ({ deviceType }) => {\n  const { data: deliverData, error: deliveryError, loading: deliveryLoading, refetch: deliveryRefetch } =  useQuery(DELIVERY_METHOD)\n  const { data: paymentData, error: paymentError, loading: paymentLoading, refetch: paymentRefetch } = useQuery(PAYMENT_OPTION);\n  deliveryRefetch();\n  paymentRefetch();\n\n  const { data, error, loading } = useQuery(GET_LOGGED_IN_USER);\n\n  if (loading || deliveryLoading || paymentLoading) {\n    return <ErrorMessage message={'Loading...'} />\n  }\n  if (error || deliveryError || paymentError) {\n    setTimeout(function () {\n      Router.push('/');\n    }, 2000)\n    return (\n      <ErrorMessage message={'Please login for checkout'} />\n    );\n  } \n  const token = 'true';\n\n\n  console.dir(deliverData.deliveryMethods)\n  console.dir(paymentData.paymentOptions)\n\n  const checkoutData = {\n    ...data.getUser, \n    deliveryMethods: [],\n    paymentMethods: [],\n  }\n\n\n console.dir(deliverData)\n  console.dir(paymentData)\nconsole.log(checkoutData, checkoutData.deliveryMethods.length, checkoutData.paymentMethods.length)\n\n  if(checkoutData.deliveryMethods.length == 0 && (deliverData || deliverData.deliveryMethods)) {\n    checkoutData.deliveryMethods = [...deliverData.deliveryMethods.items];\n  }\n\n  if(checkoutData.paymentMethods.length == 0 && (paymentData || paymentData.paymentOptions)) {\n    checkoutData.paymentMethods = [...paymentData.paymentOptions.items];\n  }\n\n\n\n  return (\n    <>\n      <SEO title=\"Checkout - Mahdi Fashion\" description=\"Checkout Details\" />\n      <ProfileProvider initData={checkoutData}>\n        <Modal>\n          <Checkout token={token} deviceType={deviceType} />\n        </Modal>\n      </ProfileProvider>\n    </>\n  );\n};\n\nexport default CheckoutPage;\n"]},"metadata":{},"sourceType":"module"}